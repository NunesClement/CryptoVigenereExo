<!DOCTYPE html>
<html>
<head>
<title>TP1</title>
</head>

<body>
  <script>

    var list = ["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];
    var chaineACrypter = 'MERCIVIGNERE';
    var maCle = 'CLEF';

    var chaineDecryptee = [];

    var nouvCle = [];

    var chaineIndice = [];
    var cleIndice = [];
    var j = 0;

    var Addition = [];
    var Soustraction = [];

    var chaineCryptee = [];
    var repetitionChaine = "OVVXRZAMGYCPZINXLKFRCBKSHRKMVRRLBMGKVVWQCUAPREOQJSTLMXQCUAPRVLFXRESIME";
    var repetitionChaine2 = "OVVXRZAMGYCPZINXLKFRCBKSHRKMVRRLBMGKVVWQCUAPREOQJSTLMXQCUAPRVLFXRESIME";

    var monSet = new Set();
    var tableD = [];
    var listeRep = [];



    agrandirCle();
    transformerLettreEnChiffre();
    additionner();
    crypter();
    soustraire();
    decrypter();
    for(var i=0; i<15;i++){
      repetitionLongueur();
    }
    tailleCle();

    //Il n'y a pas d'optimisation mais tout est décomposé pour montrer les étapes.

    function agrandirCle(){
        for(var i = 0; i<chaineACrypter.length;i++){
          nouvCle[i] = maCle[i%maCle.length];
        }
      }

    function transformerLettreEnChiffre(){
      for(var j = 0; j<list.length; j++){
        for(var k = 0; k<chaineACrypter.length; k++){
          if(chaineACrypter[k] == list[j]){
            chaineIndice[k] = j;
          }
        }
        for(var l = 0; l<nouvCle.length;l++){
          if(nouvCle[l] == list[j]){
            cleIndice[l] = j;
          }
        }
      }
    }

    function additionner(){
      for(var i = 0; i<nouvCle.length;i++){
        Addition[i] = cleIndice[i]+chaineIndice[i];
      }
      console.log(Addition);
    }

    function crypter(){
      for(var j = 0; j<list.length; j++){
        for(var k = 0; k<Addition.length; k++){
          if(Addition[k] == j){
            chaineCryptee[k] = list[j];
          }
        }
      }
      console.log(chaineCryptee);
    }

    function soustraire(){
      for(var i = 0; i<nouvCle.length;i++){
        Soustraction[i] = Addition[i]-cleIndice[i];
      }
      console.log(Soustraction);
    }

    function decrypter(){
      for(var j = 0; j<list.length; j++){
        for(var k = 0; k<Soustraction.length; k++){
          if(Soustraction[k] == j){
            chaineDecryptee[k] = list[j];
          }
        }
      }
      console.log(chaineDecryptee);
    }

    function repetitionLongueur(){
      var temprep = "";
      var secrep = "";
      var ptemprep = "";
      var psecrep = "";
      var decalage = 0;
      var k = 0;
      var e = 1;
      var nouvTaille = 0;
      var m = 0;
      var pos1 = 0;
      for(var i=0; i<repetitionChaine2.length;i++){
        for(var j=0; j<repetitionChaine2.length;j++){
            if(repetitionChaine2.charAt(j)+repetitionChaine2.charAt(j+1) == repetitionChaine2.charAt(i)+repetitionChaine2.charAt(i+1) && i != j){
              while(temprep == secrep && ptemprep == psecrep){
                temprep += repetitionChaine2.charAt(j+k);
                secrep += repetitionChaine2.charAt(i+k);
                ptemprep += repetitionChaine2.charAt(j+k+1);
                psecrep += repetitionChaine2.charAt(i+k+1);
                k++;
              }
              decalage = Math.abs(j+1);
              repetitionChaine2 = repetitionChaine2.replace(secrep,'');
              repetitionChaine2 = repetitionChaine2.replace(temprep,'');
              pos1 = repetitionChaine.indexOf(secrep);
              var temp = repetitionChaine.replace(secrep,'');
              pos2 = temp.indexOf(secrep);

              nouvTaille = repetitionChaine2.length;
          }
        }
      }
      if(decalage != 0){
        pos2 = pos2+secrep.length;
        console.log("posUne "+pos1+ " posDeux "+pos2);
        listeRep.push(Math.abs(pos1-pos2));
        console.log(listeRep);
      }

    }

    function tailleCle(){
      // for(var i =0; i<listeRep.length;i++){
      //   console.log(listeRep[i]);
      // }
      var sup = listeRep[1];
      var min = listeRep[4];
      for(var i = 0;i<tableD.length;i++){
        if(tableD[i]>=sup){
          sup = tableD[i];
        }
      }
      for(var i = 0;i<tableD.length;i++){
        if(tableD[i]<=sup && tableD[i]>0){
          min = tableD[i];
        }
      }
      b = min;
      a = sup;
      while (b != 0) {
          if (a > b)
              a = a - b;
          else
              b = b - a;
      }

 console.log(result);
}
    }
  </script>

</body>

</html>
